<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Okapi Dergi</title>
    <meta name="description" content="Okapi Dergi — çağdaş edebiyat ve sanat dergisi." />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Spectral:wght@300;400;500;600&family=Caveat:wght@500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="noise"></div>

    <header class="site-header">
      <div class="container header-inner">
        <div class="brand-lockup">
          <a class="brand" href="#top" aria-label="Okapi Dergi">
            <img src="assets/logo.PNG" alt="Okapi Dergi" decoding="async" />
          </a>
        </div>
        <nav class="nav">
          <a href="#son-sayi">Son Sayı</a>
          <a href="#sayilar">Sayılar</a>
          <a href="#hakkinda">Hakkında</a>
          <a href="#eser">Eser</a>
          <a href="#iletisim">İletişim</a>
        </nav>
        <a class="btn pill" href="https://www.shopier.com/okapidergi" target="_blank" rel="noreferrer">Mağaza</a>
      </div>
    </header>

    <main id="top">
      <section class="hero">
        <div class="container hero-stack">
          <div class="hero-copy">
            <p class="kicker">OKAPI EDEBİYAT VE KÜLTÜR SANAT DERGİSİ</p>
            <h1 class="hero-script">“Okapi, edebiyat kadar nadir.”</h1>
            <p class="lead">
              İki ayda bir yayımlanan bağımsız bir dergi. Her sayı tek bir tema
              etrafında kurulur; metin, görsel ve düşünce aynı ritimde buluşur.
            </p>
            <div class="meta">
              <span>Yayın periyodu: 2 ayda bir</span>
              <span>Instagram: @okapidergi</span>
            </div>
            <div class="social-strip">
              <a href="https://www.instagram.com/okapidergi/" target="_blank" rel="noreferrer">INSTAGRAM</a>
              <a href="https://x.com/okapidergi" target="_blank" rel="noreferrer">X</a>
              <a href="https://www.youtube.com/@okapidergi" target="_blank" rel="noreferrer">YOUTUBE</a>
              <a href="https://open.spotify.com" target="_blank" rel="noreferrer">SPOTİFY</a>
            </div>
          </div>
          <div id="son-sayi" class="hero-cover centered">
            <a class="hero-link" href="https://www.shopier.com/okapidergi" target="_blank" rel="noreferrer">
              <div class="hero-cover-inner">
                <img data-hero-image src="assets/sayi_9.png" alt="Okapi 9. Sayı kapağı" loading="eager" fetchpriority="high" decoding="async" />
              </div>
            </a>
            <div class="hero-tag" data-hero-tag>Yeni Sayı · 9</div>
          </div>
          <div class="hero-bottom">
            <div class="hero-actions">
              <a class="btn ghost" href="https://www.shopier.com/okapidergi" target="_blank" rel="noreferrer">Satın Al</a>
            </div>
          </div>
        </div>
      </section>

      <section id="sayilar" class="issues">
        <div class="container">
          <div class="section-title">
            <h2>Sayılar</h2>
          </div>
          <div class="issues-orbit" data-orbit></div>
        </div>
      </section>

      <section id="hakkinda" class="about">
        <div class="container about-grid">
          <div>
            <h2>Hakkında</h2>
            <p>
              Okapi, edebiyatın sessiz ama kalıcı izini sürer. Her sayıda tek bir
              tema etrafında yeni metinler, denemeler ve görsel işler bir araya
              gelir; düşüncenin ritmiyle kurulan bir okuma alanı açılır. İki ayda
              bir yayımlanan bu seçki, okurla buluştuğunda tamamlanır.
            </p>
          </div>
          <div class="about-card">
            <h3>İletişim</h3>
            <p><a href="mailto:okapiyayinlari@gmail.com">okapiyayinlari@gmail.com</a></p>
            <p><a href="https://www.instagram.com/okapidergi/" target="_blank" rel="noreferrer">instagram.com/okapidergi</a></p>
          </div>
        </div>
      </section>

      <section id="eser" class="submit">
        <div class="container submit-grid">
          <div>
            <p class="kicker">Eser Gönderimi</p>
            <h2>Eserlerinizi bekliyoruz.</h2>
            <p>
              Gönderimler Google Form üzerinden alınır. Eserler daha önce yayımlanmamış
              olmalı ve belirtilen formatlara uygun hazırlanmalıdır. Duyurular için
              Instagram hesabımızı takip edebilirsiniz.
            </p>
          </div>
          <div class="submit-card">
            <h3>Özet Kurallar</h3>
            <div id="kurallar"></div>
            <ul>
              <li>Türler: öykü, deneme, şiir, inceleme, eleştiri, röportaj, makale</li>
              <li>Format: .doc/.docx · Times New Roman · 12 punto · 1.5 satır</li>
              <li>Uzunluk: öykü/deneme en fazla 2 sayfa, şiir 1 sayfa, makale 3 sayfa</li>
              <li>Form: https://forms.gle/HHni7CXvbAJkHDRd9</li>
            </ul>
            <a class="btn primary" href="https://forms.gle/HHni7CXvbAJkHDRd9" target="_blank" rel="noreferrer">Formu Aç</a>
          </div>
        </div>
      </section>

      <section id="iletisim" class="contact">
        <div class="container contact-grid">
          <h2>İletişim</h2>
          <p>E-posta ve Instagram üzerinden bize ulaşabilirsiniz.</p>
          <div class="contact-actions">
            <a class="btn ghost" href="https://www.instagram.com/okapidergi/" target="_blank" rel="noreferrer">Instagram</a>
            <a class="btn ghost" href="mailto:okapiyayinlari@gmail.com">E-posta</a>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <span>© 2026 Okapi Dergi</span>
        <span><a href="https://okapiyayinlari.wordpress.com/" target="_blank" rel="noreferrer">okapiyayinlari.wordpress.com</a></span>
      </div>
    </footer>

    <script>
      (() => {
        const orbit = document.querySelector("[data-orbit]");
        if (!orbit) return;

        const buildItem = (item) => {
          const article = document.createElement("article");
          article.className = "issue";

          const link = document.createElement("a");
          link.className = "issue-cover";
          link.href = item.shopier_url || "https://www.shopier.com/okapidergi";
          link.target = "_blank";
          link.rel = "noreferrer";

          const img = document.createElement("img");
          img.src = item.image;
          img.alt = `Okapi ${item.number}. Sayı kapağı`;
          img.loading = "lazy";
          img.decoding = "async";

          const body = document.createElement("div");
          body.className = "issue-body";

          const h3 = document.createElement("h3");
          h3.textContent = `${item.number}. Sayı`;

          link.appendChild(img);
          body.appendChild(h3);
          article.appendChild(link);
          article.appendChild(body);

          return article;
        };

        const initOrbit = () => {
          const items = Array.from(orbit.querySelectorAll(".issue"));
          if (!items.length) return;

          const baseRadius = () => Math.min(230, orbit.offsetWidth / 2.9);
          let angleOffset = 0;
          let targetOffset = 0;
          let scrollOffset = 0;
          let scrollDir = 1;
          let rafId = null;

          const positionItems = () => {
            const r0 = baseRadius();
            items.forEach((item, i) => {
              const angle = (i / items.length) * Math.PI * 2 + angleOffset;
            const x = Math.cos(angle) * r0 * 1.8;
            const y = Math.sin(angle) * r0 * 0.7;
            const depth = Math.max(0.55, (y + r0 * 0.8) / (r0 * 1.6));
            const baseScale = parseFloat(getComputedStyle(item).getPropertyValue("--scale") || 1);
            const hoverBoost = item.matches(":hover") ? 1.18 : 1;
            const scale = depth * baseScale * hoverBoost;
            item.style.left = "50%";
            item.style.top = "50%";
            item.style.transform = `translate(-50%, -50%) translate3d(${x}px, ${y}px, 0) scale(${scale})`;
            const z = Math.round((y + r0 * 0.8) * 100);
            item.style.zIndex = z;
            item.style.opacity = "1";
            });
          };

          const onMove = (e) => {
            const rect = orbit.getBoundingClientRect();
            const cx = rect.left + rect.width / 2;
            const cy = rect.top + rect.height / 2;
            const dx = (e.clientX - cx) / rect.width;
            const dy = (e.clientY - cy) / rect.height;
            targetOffset = (dx + dy) * 2.2;
            if (!rafId) rafId = requestAnimationFrame(tick);
          };

          const onScroll = () => {
            scrollDir = scrollDir * -1;
            scrollOffset += scrollDir * 0.035;
            if (!rafId) rafId = requestAnimationFrame(tick);
          };

          const onLeave = () => {
            targetOffset = 0;
            if (!rafId) rafId = requestAnimationFrame(tick);
          };

          const tick = () => {
            angleOffset += (targetOffset + scrollOffset - angleOffset) * 0.06;
            positionItems();
            if (Math.abs(targetOffset - angleOffset) > 0.001) {
              rafId = requestAnimationFrame(tick);
            } else {
              rafId = null;
            }
          };

          orbit.addEventListener("mousemove", onMove);
          orbit.addEventListener("mouseleave", onLeave);
          window.addEventListener("scroll", onScroll, { passive: true });
          window.addEventListener("resize", positionItems);
          positionItems();
        };

        fetch("/data/issues.json")
          .then((res) => {
            if (!res.ok) {
              throw new Error(`HTTP ${res.status}`);
            }
            return res.json();
          })
          .then((data) => {
            const items = (data.items || []).slice().sort((a, b) => b.number - a.number);
            if (!items.length) return;

            const latest = items[0];
            const heroImg = document.querySelector("[data-hero-image]");
            const heroTag = document.querySelector("[data-hero-tag]");
            const heroLink = document.querySelector(".hero-link");

            if (heroImg) {
              heroImg.src = latest.image;
              heroImg.alt = `Okapi ${latest.number}. Sayı kapağı`;
            }
            if (heroTag) {
              heroTag.textContent = `Yeni Sayı · ${latest.number}`;
            }
            if (heroLink) {
              heroLink.href = latest.shopier_url || "https://www.shopier.com/okapidergi";
            }

            items.slice(1).forEach((item) => orbit.appendChild(buildItem(item)));
            initOrbit();
          })
          .catch((err) => {
            console.error("Arşiv yüklenemedi:", err);
            orbit.innerHTML = "<p>Arşiv yüklenemedi.</p>";
          });
      })();
    </script>
  </body>
</html>
